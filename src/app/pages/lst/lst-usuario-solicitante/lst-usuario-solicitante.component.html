<div class="container my-5">
  <div class="card shadow-lg border-0">
    <div
      class="card-header bg-primary text-white d-flex justify-content-between align-items-center rounded-top"
    >
      <h4 class="m-0">
        <i class="bi bi-people-fill me-2"></i> Lista de solicitantes
      </h4>
      <button
        type="button"
        class="btn btn-light text-primary fw-semibold shadow-sm"
        (click)="abmAgregarNuevo(0)"
      >
        <i class="bi bi-person-plus-fill me-2"></i> Agregar nuevo
      </button>
    </div>

    <div class="card-body bg-light">
      <!-- Filtro -->
      <div
        class="d-flex flex-wrap justify-content-between align-items-center mb-4 gap-3 w-100"
      >
        <app-fil-usuario-solicitante
          (emmit)="doFound($event)"
          class="flex-grow-1"
        ></app-fil-usuario-solicitante>
      </div>

      <!-- Tabla -->
      <div class="table-responsive rounded shadow-sm">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-primary">
            <tr>
              <th>#</th>
              <th>Nombre</th>
              <th>Apellido</th>
              <th>DNI</th>
              <th>Jerarquía</th>
              <th>Unidad</th>
              <th>Fecha Solicitud Alta</th>
              <th class="text-center">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of items; index as i">
              <td>{{ item.id }}</td>
              <td>{{ item.nombre }}</td>
              <td>{{ item.apellido }}</td>
              <td>{{ item.dni }}</td>
              <td>{{ item.jerarquia }}</td>
              <td>{{ item.nombreUnidad }}</td>
              <td>{{ item.fechaSolEcom | date : "dd/MM/yyyy" }}</td>
              <td class="text-center">
                <button
                  class="btn btn-sm btn-outline-info"
                  title="Asignar correo"
                  (click)="abmCorreo(item.id)"
                >
                  <i class="bi bi-envelope-at-fill"></i>
                </button>
                &nbsp;
                <button
                  class="btn btn-sm btn-outline-primary me-2"
                  title="Editar jerarquía"
                  data-bs-toggle="modal"
                  data-bs-target="#modalJerarquia"
                  (click)="setUsuarioSeleccionado(item)"
                >
                  <i class="bi bi-pencil-square"></i>
                </button>
                <button
                  class="btn btn-sm btn-outline-danger"
                  title="Eliminar"
                  (click)="eliminar(item.id)"
                >
                  <i class="bi bi-trash"></i>
                </button>
              </td>
            </tr>

            <tr *ngIf="items.length === 0">
              <td colspan="9" class="text-center text-muted py-3">
                <i class="bi bi-exclamation-circle me-2"></i> No hay personas
                registradas.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div
      class="card-footer text-end text-muted small bg-white border-top fw-semibold"
    >
      Mostrando {{ items.length }} personas
    </div>
  </div>
</div>

<!-- Modal -->
<div
  class="modal fade"
  id="modalJerarquia"
  tabindex="-1"
  aria-labelledby="modalJerarquiaLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalJerarquiaLabel">Actualizar datos</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="selectJerarquia" class="col-form-label"
            >Seleccionar:</label
          >
          <select
            id="selectJerarquia"
            class="form-select"
            [(ngModel)]="usuarioSeleccionado.jerarquia"
          >
            <option [ngValue]="null" disabled selected>
              Seleccione una jerarquía
            </option>
            <option value="COMISARIO GENERAL">COMISARIO GENERAL</option>
            <option value="COMISARIO MAYOR">COMISARIO MAYOR</option>
            <option value="COMISARIO INSPECTOR">COMISARIO INSPECTOR</option>
            <option value="COMISARIO PRINCIPAL">COMISARIO PRINCIPAL</option>
            <option value="COMISARIO">COMISARIO</option>
            <option value="SUBCOMISARIO">SUBCOMISARIO</option>
            <option value="OFICIAL PRINCIPAL">OFICIAL PRINCIPAL</option>
            <option value="OFICIAL AUXILIAR">OFICIAL AUXILIAR</option>
            <option value="OFICIAL AYUDANTE">OFICIAL AYUDANTE</option>
            <option value="OFICIAL SUBAYUDANTE">OFICIAL SUBAYUDANTE</option>
            <option value="SUBOFICIAL MAYOR">SUBOFICIAL MAYOR</option>
            <option value="SUBOFICIAL PRINCIPAL">SUBOFICIAL PRINCIPAL</option>
            <option value="SARGENTO AYUDANTE">SARGENTO AYUDANTE</option>
            <option value="SARGENTO PRIMERO">SARGENTO PRIMERO</option>
            <option value="SARGENTO">SARGENTO</option>
            <option value="CABO PRIMERO">CABO PRIMERO</option>
            <option value="CABO">CABO</option>
            <option value="AGENTE">AGENTE</option>
          </select>
          <hr />
          <label for="selectJerarquia" class="col-form-label">Unidad:</label>
          <app-fil-autocompletado-unidad
            (unidadSeleccionada)="unidadSeleccionada($event)"
          ></app-fil-autocompletado-unidad>
        </div>
        <label for="selectJerarquia" class="col-form-label"
          >Unidad Seleccionada: {{ item.nombreUnidad }}</label
        >
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Cancelar
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="actualizarJerarquia()"
        >
          Guardar cambios
        </button>
      </div>
    </div>
  </div>
</div>
